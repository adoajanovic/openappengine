<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      template="/templates/page-template.xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:ice="http://www.icesoft.com/icefaces/component"
      xmlns:openui="http://www.openappengine.com/tags/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
      
      <ui:define name="page-content">
      		<f:view>
      			<!-- Register Entity Form Phase Listener -->
      			<f:phaseListener binding="#{entityFormController.entityFormPhaseListener}" />
      			
      			<!--  Metadata Params for this View -->
      			<f:metadata>
		      		<!-- 
			      	   As we are using this container for loading Entity Forms (Either New/Restoring from DB based on PK's), 
			      	   we expect that the EntityName and EntityId is passed as request params 
		      	   -->
					<f:viewParam name="formName" value="#{entityFormController.entityFormRequest.formName}" 
						required="true"
						requiredMessage="Request Parameter : entityName expected">
					</f:viewParam>
					<f:viewParam name="entityId" value="#{entityFormController.entityFormRequest.entityId}"/>
				</f:metadata>
	      	   
	      	   <f:viewParam name="formInstance" value="#{entityFormController.formInstance}" />
	      	   <f:viewParam name="formDefinition" value="#{formInstance.formDefinition}" />
	      	   <f:viewParam name="entityValue" value="#{formInstance.entityValue}" />
	      	   <f:viewParam name="formLayout" value="#{formDefinition.formLayout}" />
	      	   
	           <h:panelGroup id="EntityFormDiv">
	           		<openui:entityForm entityName="#{entityValue.entityName}" id="#{formDefinition.name}_Form" columns="#{formLayout.columns}">
					</openui:entityForm>	
	           </h:panelGroup>
	      	   
      		</f:view>
      </ui:define>
</ui:composition>